<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-11-30 Mo 16:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spherical Series</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Johann-Markus Batke" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Spherical Series</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org5f0ad94">1. General Information</a></li>
<li><a href="#org6865624">2. Spherical Mathematics</a>
<ul>
<li><a href="#org2437a28">2.1. Fourier Bessel Series</a></li>
<li><a href="#org790ee0e">2.2. HOA Series</a></li>
<li><a href="#org8a6c079">2.3. Spherical Fourier Transform</a></li>
</ul>
</li>
<li><a href="#org233f261">3. Spherical Functions</a>
<ul>
<li><a href="#org5bac03b">3.1. sphericalbesselj</a>
<ul>
<li><a href="#org794723c">3.1.1. Syntax</a></li>
<li><a href="#org7f78e56">3.1.2. Description</a></li>
<li><a href="#org3f71944">3.1.3. Input Arguments</a></li>
<li><a href="#orgdb97195">3.1.4. Return Values</a></li>
<li><a href="#org084c78f">3.1.5. Examples</a></li>
<li><a href="#org0568e66">3.1.6. Tips</a></li>
<li><a href="#org30298d2">3.1.7. Alternatives</a></li>
<li><a href="#orgb5ea5dc">3.1.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgbcd6e4a">3.2. sphericalbessel</a>
<ul>
<li><a href="#org2ac1759">3.2.1. Syntax</a></li>
<li><a href="#org5b24e5b">3.2.2. Description</a></li>
<li><a href="#org209ae7e">3.2.3. Input Arguments</a></li>
<li><a href="#orgd29fc78">3.2.4. Return Values</a></li>
<li><a href="#org1292259">3.2.5. Examples</a></li>
<li><a href="#org32b47b7">3.2.6. Tips</a></li>
<li><a href="#orgdb98050">3.2.7. Alternatives</a></li>
<li><a href="#org5c5474c">3.2.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgc748c74">3.3. sphericalbessely</a>
<ul>
<li><a href="#org8633aba">3.3.1. Syntax</a></li>
<li><a href="#org0cb87d0">3.3.2. Description</a></li>
<li><a href="#org4cc9fe6">3.3.3. Input Arguments</a></li>
<li><a href="#org1105f14">3.3.4. Return Values</a></li>
<li><a href="#org8265740">3.3.5. Examples</a></li>
<li><a href="#orged3ede2">3.3.6. Tips</a></li>
<li><a href="#orga12d1cb">3.3.7. Alternatives</a></li>
<li><a href="#org373e7d6">3.3.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgb8d30b1">3.4. sphericalneumann</a>
<ul>
<li><a href="#org59707b4">3.4.1. Syntax</a></li>
<li><a href="#org21f057b">3.4.2. Description</a></li>
<li><a href="#org5dbd161">3.4.3. Input Arguments</a></li>
<li><a href="#org9f8522f">3.4.4. Return Values</a></li>
<li><a href="#org69c4c55">3.4.5. Examples</a></li>
<li><a href="#orgcf3641b">3.4.6. Tips</a></li>
<li><a href="#org0306354">3.4.7. Alternatives</a></li>
<li><a href="#org05956f5">3.4.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgab97d9c">3.5. sphericalhankel</a>
<ul>
<li><a href="#orga84f2ef">3.5.1. Syntax</a></li>
<li><a href="#orgf51bcb7">3.5.2. Description</a></li>
<li><a href="#org8463bc1">3.5.3. Input Arguments</a></li>
<li><a href="#org834ea7f">3.5.4. Return Values</a></li>
<li><a href="#orga03a0ea">3.5.5. Examples</a></li>
<li><a href="#orge381629">3.5.6. Tips</a></li>
<li><a href="#org264d94e">3.5.7. Alternatives</a></li>
<li><a href="#org5369bcf">3.5.8. See Also</a></li>
</ul>
</li>
<li><a href="#orga49e355">3.6. sphericalbessel<sub>r</sub></a></li>
<li><a href="#org1262d76">3.7. sphericalnormalisation</a>
<ul>
<li><a href="#org4dc3259">3.7.1. Syntax</a></li>
<li><a href="#org49df515">3.7.2. Description</a></li>
<li><a href="#org31c4fb2">3.7.3. Input Arguments</a></li>
<li><a href="#orgc2c305c">3.7.4. Return Values</a></li>
<li><a href="#orgc9f4c0c">3.7.5. Examples</a></li>
<li><a href="#org23661e6">3.7.6. Tips</a></li>
<li><a href="#orga26226b">3.7.7. Alternatives</a></li>
<li><a href="#org1c50592">3.7.8. See Also</a></li>
</ul>
</li>
<li><a href="#org5adef3c">3.8. sphericallegendre</a>
<ul>
<li><a href="#org0d781e3">3.8.1. Syntax</a></li>
<li><a href="#org5e436ba">3.8.2. Description</a></li>
<li><a href="#org704a8ce">3.8.3. Input Arguments</a></li>
<li><a href="#org86a99ce">3.8.4. Return Values</a></li>
<li><a href="#org91e4c37">3.8.5. Examples</a></li>
<li><a href="#orga0ad906">3.8.6. See Also</a></li>
</ul>
</li>
<li><a href="#orgcdf0570">3.9. trg</a>
<ul>
<li><a href="#org8edb7a9">3.9.1. Syntax</a></li>
<li><a href="#org9d0be4f">3.9.2. Description</a></li>
<li><a href="#org5910847">3.9.3. Input Arguments</a></li>
<li><a href="#org4e4abb0">3.9.4. Return Values</a></li>
<li><a href="#org5dadf33">3.9.5. Examples</a></li>
<li><a href="#org745a30b">3.9.6. Tips</a></li>
<li><a href="#orgb64e937">3.9.7. Alternatives</a></li>
<li><a href="#org5077924">3.9.8. See Also</a></li>
</ul>
</li>
<li><a href="#org1684aa1">3.10. trh</a>
<ul>
<li><a href="#org39b2008">3.10.1. Syntax</a></li>
<li><a href="#org58954a8">3.10.2. Description</a></li>
<li><a href="#org8cea8cf">3.10.3. Input Arguments</a></li>
<li><a href="#orgc944d4f">3.10.4. Return Values</a></li>
<li><a href="#org3f28504">3.10.5. Examples</a></li>
<li><a href="#orgabb00dc">3.10.6. Tips</a></li>
<li><a href="#org41ceb55">3.10.7. Alternatives</a></li>
<li><a href="#org65191f7">3.10.8. See Also</a></li>
</ul>
</li>
<li><a href="#org98c3e13">3.11. sphericalazimuth</a>
<ul>
<li><a href="#org857c7eb">3.11.1. Syntax</a></li>
<li><a href="#orgc09dcec">3.11.2. Description</a></li>
<li><a href="#orgf4484ec">3.11.3. Input Arguments</a></li>
<li><a href="#org34e226d">3.11.4. Return Values</a></li>
<li><a href="#org3efe74d">3.11.5. Examples</a></li>
<li><a href="#orgeecf8aa">3.11.6. Tips</a></li>
<li><a href="#orga36db29">3.11.7. Alternatives</a></li>
<li><a href="#org98d0322">3.11.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgdfa86aa">3.12. sphericalharmonic</a>
<ul>
<li><a href="#org385f9fd">3.12.1. Syntax</a></li>
<li><a href="#orgaaf26ab">3.12.2. Description</a></li>
<li><a href="#org7840310">3.12.3. Input Arguments</a></li>
<li><a href="#orgbf9c76c">3.12.4. Return Values</a></li>
<li><a href="#org4d83674">3.12.5. Examples</a></li>
<li><a href="#org73f66f7">3.12.6. Tips</a></li>
<li><a href="#org2070c5e">3.12.7. Alternatives</a></li>
<li><a href="#org499c013">3.12.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgdad862c">3.13. sphericalmodematrix</a>
<ul>
<li><a href="#org0838e15">3.13.1. Syntax</a></li>
<li><a href="#org5de07c3">3.13.2. Description</a></li>
<li><a href="#org1c6a728">3.13.3. Input Arguments</a></li>
<li><a href="#org870f696">3.13.4. Return Values</a></li>
<li><a href="#org76514c4">3.13.5. Examples</a></li>
<li><a href="#org4b0ec21">3.13.6. Tips</a></li>
<li><a href="#org7a90fb4">3.13.7. Alternatives</a></li>
<li><a href="#org969e7de">3.13.8. See Also</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9838a67">4. Spherical Fourier Transform</a>
<ul>
<li><a href="#org45c4966">4.1. sphericalseries<sub>isfs</sub></a>
<ul>
<li><a href="#org7d22960">4.1.1. Syntax</a></li>
<li><a href="#org97acfa6">4.1.2. Description</a></li>
<li><a href="#org48d6262">4.1.3. Input Arguments</a></li>
<li><a href="#org438e8a1">4.1.4. Return Values</a></li>
<li><a href="#org8867615">4.1.5. Examples</a></li>
<li><a href="#org71e8315">4.1.6. Tips</a></li>
<li><a href="#orgc0b42b2">4.1.7. Alternatives</a></li>
<li><a href="#org7e14e95">4.1.8. See Also</a></li>
</ul>
</li>
<li><a href="#orgc0c9da0">4.2. sphericalseries<sub>isf</sub></a></li>
<li><a href="#org1522790">4.3. sphericalseries<sub>sfc</sub></a>
<ul>
<li><a href="#orge7cdace">4.3.1. Syntax</a></li>
<li><a href="#org9127ad9">4.3.2. Description</a></li>
<li><a href="#org65fb6c3">4.3.3. Input Arguments</a></li>
<li><a href="#org50e7f04">4.3.4. Return Values</a></li>
<li><a href="#org7ecdd63">4.3.5. Examples</a></li>
<li><a href="#org040b188">4.3.6. Tips</a></li>
<li><a href="#org40102be">4.3.7. Alternatives</a></li>
<li><a href="#orgf55fc33">4.3.8. See Also</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4d9a43c">5. Higher Order Ambisonics</a>
<ul>
<li><a href="#org0c8015b">5.1. Sphericalseries<sub>hoa</sub></a></li>
<li><a href="#orge48bdde">5.2. Sphericalseries<sub>hoa</sub><sub>plane</sub></a>
<ul>
<li><a href="#org7768a85">5.2.1. Syntax</a></li>
<li><a href="#orgfe0b188">5.2.2. Description</a></li>
<li><a href="#org9f86705">5.2.3. Input Arguments</a></li>
<li><a href="#orgf4136e7">5.2.4. Return Values</a></li>
<li><a href="#orga7d1380">5.2.5. Examples</a></li>
<li><a href="#orgce2b0bd">5.2.6. Tips</a></li>
<li><a href="#orga918ccd">5.2.7. Alternatives</a></li>
<li><a href="#org5fd9d07">5.2.8. See Also</a></li>
</ul>
</li>
<li><a href="#org7cc0e69">5.3. sphericalseries<sub>hoa</sub><sub>spherical</sub></a></li>
<li><a href="#org6400760">5.4. sphericalseries<sub>hoa</sub><sub>basis</sub></a>
<ul>
<li><a href="#orgce49fab">5.4.1. Syntax</a></li>
<li><a href="#orgb417f91">5.4.2. Description</a></li>
<li><a href="#org831066b">5.4.3. Input Arguments</a></li>
<li><a href="#org682a674">5.4.4. Return Values</a></li>
<li><a href="#org7da69c5">5.4.5. Examples</a></li>
<li><a href="#org584dbca">5.4.6. Tips</a></li>
<li><a href="#orgf1ecf6b">5.4.7. Alternatives</a></li>
<li><a href="#org92503b5">5.4.8. See Also</a></li>
</ul>
</li>
<li><a href="#org05ca26a">5.5. sphericalseries<sub>sfc</sub></a></li>
</ul>
</li>
<li><a href="#orgce878ac">6. Examples</a>
<ul>
<li><a href="#orgfe879d5">6.1. Plane wave</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org5f0ad94" class="outline-2">
<h2 id="org5f0ad94"><span class="section-number-2">1</span> General Information</h2>
<div class="outline-text-2" id="text-1">
<p>
This is all about Higher Order Ambisonics.
</p>

<p>
We need to implement some math.
</p>
</div>
</div>
<div id="outline-container-org6865624" class="outline-2">
<h2 id="org6865624"><span class="section-number-2">2</span> Spherical Mathematics</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org2437a28" class="outline-3">
<h3 id="org2437a28"><span class="section-number-3">2.1</span> Fourier Bessel Series</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Spherical Series provides means to calculate the "Fourier Bessel
Series".  The form of this series is
</p>
\begin{equation}
  \label{eq:fbs}
  P(r, \theta, \phi, k) = \sum_{n = 0}^{\infty} \sum_{m = -n}^{n} 
  \left\{\begin{array}{ll}
  A_{n}^{m}(k) & j_n(kr) \\
  B_{n}^{m}(k) & h_n(kr) \\
  \end{array}\right\}
  Y_{n}^{m}(\theta, \phi).
\end{equation}

<p>
In particular, we have
</p>
<ul class="org-ul">
<li>\(A_{n}^{m}(k)\) coefficients describing a soundfield outside</li>
<li>\(B_{n}^{m}(k)\) coefficients describing a soundfield inside</li>
<li>\(j_n(kr)\) the spherical bessel function</li>
<li>\(h_n(kr)\) the spherical hankel function</li>
<li>\(Y_{n}^{m}(\theta, \phi)\) spherical harmonics</li>
<li>\(k = \omega/\mathrm c\) wavenumber</li>
<li>\(\mathrm c\) speed of sound</li>
</ul>
</div>
</div>

<div id="outline-container-org790ee0e" class="outline-3">
<h3 id="org790ee0e"><span class="section-number-3">2.2</span> HOA Series</h3>
<div class="outline-text-3" id="text-2-2">
<p>
The product \(j_n(kr) \, Y_{n}^{m}(\theta, \phi)\) may combined to a
basefunction \(R_n^m(r, \theta, \phi, k)\) and \(h_n(kr) \,
Y_{n}^{m}(\theta, \phi)\) is combined to basefunction \(S_n^m(r, \theta,
\phi, k)\) yielding
</p>
\begin{equation}
  \label{eq:1r}
  P(r, \theta, \phi, k) = \sum_{n = 0}^{\infty} \sum_{m = -n}^{n} 
  \left\{\begin{array}{ll}
      A_{n}^{m}(k) & R_n^m(r, \theta, \phi, k)\\
      B_{n}^{m}(k) & S_n^m(r, \theta, \phi, k)\\
  \end{array}\right. .
\end{equation}
</div>
</div>

<div id="outline-container-org8a6c079" class="outline-3">
<h3 id="org8a6c079"><span class="section-number-3">2.3</span> Spherical Fourier Transform</h3>
<div class="outline-text-3" id="text-2-3">
<p>
The <b>inverse spherical Fourier Transform</b> is defined as
</p>
\begin{equation}
  \label{eq:isfs}
  P(r, \theta, \phi, k) = \sum_{n = 0}^{\infty} \sum_{m = -n}^{n} 
  P_{n}^{m}(k,r) 
  Y_{n}^{m}(\theta, \phi).
\end{equation}
<p>
as found in <a class='org-ref-reference' href="#williams99_fourier_acoustic">williams99_fourier_acoustic</a> p. 208 equation (6.96). 
</p>

<p>
Combination of \(A_{n}^{m}(k)\) and \(j_n(kr)\) results in Fourier
coefficients used in the inverse transform
</p>
\begin{equation}
  \label{eq:sfs}
  P(r, \theta, \phi, k) = \sum_{n = 0}^{\infty} \sum_{m = -n}^{n} 
  \left\{\begin{array}{ll}
  C_{n}^{m}(k,r) \\
  D_{n}^{m}(k,r) \\
  \end{array}\right\}
  Y_{n}^{m}(\theta, \phi).
\end{equation}
</div>
</div>
</div>

<div id="outline-container-org233f261" class="outline-2">
<h2 id="org233f261"><span class="section-number-2">3</span> Spherical Functions</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org5bac03b" class="outline-3">
<h3 id="org5bac03b"><span class="section-number-3">3.1</span> sphericalbesselj</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<a href="sphericalbesselj.m">sphericalbesselj.m</a>: calculates spherical bessel function at order N
</p>
</div>

<div id="outline-container-org794723c" class="outline-4">
<h4 id="org794723c"><span class="section-number-4">3.1.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-1-1">
<pre class="example">
J_sph_CF = sphericalbesselj(N_order, x_CF);
</pre>
</div>
</div>

<div id="outline-container-org7f78e56" class="outline-4">
<h4 id="org7f78e56"><span class="section-number-4">3.1.2</span> Description</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
spherical bessel function at order N
</p>
</div>
</div>

<div id="outline-container-org3f71944" class="outline-4">
<h4 id="org3f71944"><span class="section-number-4">3.1.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-1-3">
<dl class="org-dl">
<dt>x<sub>CF</sub></dt><dd>C x F matrix</dd>
</dl>
</div>
</div>

<div id="outline-container-orgdb97195" class="outline-4">
<h4 id="orgdb97195"><span class="section-number-4">3.1.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-1-4">
<dl class="org-dl">
<dt>J<sub>sph</sub><sub>CF</sub></dt><dd>C x F matrix</dd>
</dl>
</div>
</div>

<div id="outline-container-org084c78f" class="outline-4">
<h4 id="org084c78f"><span class="section-number-4">3.1.5</span> Examples</h4>
</div>

<div id="outline-container-org0568e66" class="outline-4">
<h4 id="org0568e66"><span class="section-number-4">3.1.6</span> Tips</h4>
</div>

<div id="outline-container-org30298d2" class="outline-4">
<h4 id="org30298d2"><span class="section-number-4">3.1.7</span> Alternatives</h4>
</div>

<div id="outline-container-orgb5ea5dc" class="outline-4">
<h4 id="orgb5ea5dc"><span class="section-number-4">3.1.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-1-8">
</div>
<ol class="org-ol">
<li><a id="org70b643e"></a>Examples<br />
<div class="outline-text-5" id="text-3-1-8-1">
<p>
Calculate the sphericalbessel function of order 6.
</p>
<div class="org-src-container">
<pre class="src src-octave" id="orged74d35">N_order <span style="color: #00a6fb;">=</span> 6<span style="color: #00a6fb;">;</span>
x_F <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> 15<span style="color: #00a6fb;">,</span> 200)<span style="color: #00a6fb;">;</span>
J_sph_OF <span style="color: #00a6fb;">=</span> sphericalbesselj(N_order<span style="color: #00a6fb;">,</span> x_F)<span style="color: #00a6fb;">;</span>
</pre>
</div>

<p>
This results in a graph like Figure <a href="#fig:sphbesselexa6">fig:sphbesselexa6</a>.
</p>


<div id="org7d3a0f3" class="figure">
<p><img src="img/sphericalbesselj.png" alt="sphericalbesselj.png" />
</p>
<p><span class="figure-number">Figure 1: </span>The spherical bessel function of order 6. <div id="fig:sphbesselexa6"></div></p>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgbcd6e4a" class="outline-3">
<h3 id="orgbcd6e4a"><span class="section-number-3">3.2</span> sphericalbessel</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<a href="sphericalbessel.m">sphericalbessel.m</a>: wrapper for sphericalbesselj, return all orders up to N
</p>
</div>


<div id="outline-container-org2ac1759" class="outline-4">
<h4 id="org2ac1759"><span class="section-number-4">3.2.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-2-1">
<pre class="example">
J_sph_OCF = sphericalbessel(N_order, x_CF)
</pre>
</div>
</div>

<div id="outline-container-org5b24e5b" class="outline-4">
<h4 id="org5b24e5b"><span class="section-number-4">3.2.2</span> Description</h4>
<div class="outline-text-4" id="text-3-2-2">
<p>
calculate spherical besselfunction of order N<sub>order</sub> along matrix x<sub>CF</sub>.
</p>
</div>
</div>
<div id="outline-container-org209ae7e" class="outline-4">
<h4 id="org209ae7e"><span class="section-number-4">3.2.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-2-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>order</dd>
<dt>x<sub>CF</sub></dt><dd>matrix with arguments</dd>
</dl>
</div>
</div>
<div id="outline-container-orgd29fc78" class="outline-4">
<h4 id="orgd29fc78"><span class="section-number-4">3.2.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-2-4">
<dl class="org-dl">
<dt>J<sub>sph</sub><sub>OCF</sub></dt><dd>matrix of all orders 0 up to \((N_order+1)^2\) and input dimensions CF</dd>
</dl>
</div>
</div>

<div id="outline-container-org1292259" class="outline-4">
<h4 id="org1292259"><span class="section-number-4">3.2.5</span> Examples</h4>
<div class="outline-text-4" id="text-3-2-5">
<pre class="example">
N_order = 6;
x_F = linspace(0, 15, 200);
J_sph_OF = sphericalbessel(N_order, x_F);
figure(1);
plot(x_F, J_sph_OF);
xlabel('x');
ylabel('j_6(x)');
</pre>
</div>
</div>

<div id="outline-container-org32b47b7" class="outline-4">
<h4 id="org32b47b7"><span class="section-number-4">3.2.6</span> Tips</h4>
</div>

<div id="outline-container-orgdb98050" class="outline-4">
<h4 id="orgdb98050"><span class="section-number-4">3.2.7</span> Alternatives</h4>
</div>

<div id="outline-container-org5c5474c" class="outline-4">
<h4 id="org5c5474c"><span class="section-number-4">3.2.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-2-8">
<div class="org-src-container">
<pre class="src src-octave" id="org15f7b41">    N_order <span style="color: #00a6fb;">=</span> 6<span style="color: #00a6fb;">;</span>
    x_F <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> 15<span style="color: #00a6fb;">,</span> 200)<span style="color: #00a6fb;">;</span>
    J_sph_OF <span style="color: #00a6fb;">=</span> sphericalbessel(N_order<span style="color: #00a6fb;">,</span> x_F)<span style="color: #00a6fb;">;</span>
    figure(1)<span style="color: #00a6fb;">;</span>
    plot(x_F<span style="color: #00a6fb;">,</span> J_sph_OF)<span style="color: #00a6fb;">;</span>
    xlabel(<span style="color: #096b38;">'x'</span>)<span style="color: #00a6fb;">;</span>
    ylabel(<span style="color: #096b38;">'j_6(x)'</span>)<span style="color: #00a6fb;">;</span>
    xlim([0<span style="color: #00a6fb;">,</span> 15])<span style="color: #00a6fb;">;</span>
    S_file <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'img/sphericalbessel.png'</span><span style="color: #00a6fb;">;</span>
    saveas(1<span style="color: #00a6fb;">,</span> S_file)<span style="color: #00a6fb;">;</span>
    ans <span style="color: #00a6fb;">=</span> S_file<span style="color: #00a6fb;">;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc748c74" class="outline-3">
<h3 id="orgc748c74"><span class="section-number-3">3.3</span> sphericalbessely</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<a href="sphericalbessely.m">sphericalbessely.m</a>: compute the spherical Bessel's function of the second kind
</p>
</div>

<div id="outline-container-org8633aba" class="outline-4">
<h4 id="org8633aba"><span class="section-number-4">3.3.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-3-1">
<pre class="example">
N_sph = sphericalbessely(n, x)
</pre>
</div>
</div>

<div id="outline-container-org0cb87d0" class="outline-4">
<h4 id="org0cb87d0"><span class="section-number-4">3.3.2</span> Description</h4>
<div class="outline-text-4" id="text-3-3-2">
<p>
2nd kind Bessel function is computed for each element of x.If the input argument
(element of a matrix x) is = 0, the output has a value NaN.
</p>
</div>
</div>

<div id="outline-container-org4cc9fe6" class="outline-4">
<h4 id="org4cc9fe6"><span class="section-number-4">3.3.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-3-3">
<ul class="org-ul">
<li>n - Ambisonics order</li>
<li>x - matrix to return the result (should not have more than 2 dimensions)</li>
</ul>
</div>
</div>

<div id="outline-container-org1105f14" class="outline-4">
<h4 id="org1105f14"><span class="section-number-4">3.3.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-3-4">
<ul class="org-ul">
<li>N<sub>sph</sub> - matrix of the 2nd kind Bessel function values</li>
</ul>
</div>
</div>

<div id="outline-container-org8265740" class="outline-4">
<h4 id="org8265740"><span class="section-number-4">3.3.5</span> Examples</h4>
</div>

<div id="outline-container-orged3ede2" class="outline-4">
<h4 id="orged3ede2"><span class="section-number-4">3.3.6</span> Tips</h4>
</div>

<div id="outline-container-orga12d1cb" class="outline-4">
<h4 id="orga12d1cb"><span class="section-number-4">3.3.7</span> Alternatives</h4>
</div>

<div id="outline-container-org373e7d6" class="outline-4">
<h4 id="org373e7d6"><span class="section-number-4">3.3.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-3-8">
<p>
bessely
</p>
</div>
</div>
</div>

<div id="outline-container-orgb8d30b1" class="outline-3">
<h3 id="orgb8d30b1"><span class="section-number-3">3.4</span> sphericalneumann</h3>
<div class="outline-text-3" id="text-3-4">
<p>
<a href="sphericalneumann.m">sphericalneumann.m</a>: 2nd kind Bessel function for Ambisonics
coefficients are given as a vector
</p>
</div>

<div id="outline-container-org59707b4" class="outline-4">
<h4 id="org59707b4"><span class="section-number-4">3.4.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-4-1">
<pre class="example">
N_sph_OCF = sphericalneumann(N_order, x_CF)
</pre>
</div>
</div>

<div id="outline-container-org21f057b" class="outline-4">
<h4 id="org21f057b"><span class="section-number-4">3.4.2</span> Description</h4>
<div class="outline-text-4" id="text-3-4-2">
<p>
First derivative of the 2nd kind Bessel function is computed for each
element of x.If the input argument (element of a matrix x) is = 0, the
output has a value NaN.
</p>
</div>
</div>

<div id="outline-container-org5dbd161" class="outline-4">
<h4 id="org5dbd161"><span class="section-number-4">3.4.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-4-3">
<ul class="org-ul">
<li>N<sub>order</sub> - Ambisonics order</li>
<li>x<sub>CF</sub> - matrix to return the result (should not have more than 2 dimensions)</li>
</ul>
</div>
</div>

<div id="outline-container-org9f8522f" class="outline-4">
<h4 id="org9f8522f"><span class="section-number-4">3.4.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-4-4">
<ul class="org-ul">
<li>N<sub>sph</sub><sub>OCF</sub> - multi-dimensional matrix with Neumann function calculation results</li>
</ul>
</div>
</div>

<div id="outline-container-org69c4c55" class="outline-4">
<h4 id="org69c4c55"><span class="section-number-4">3.4.5</span> Examples</h4>
</div>

<div id="outline-container-orgcf3641b" class="outline-4">
<h4 id="orgcf3641b"><span class="section-number-4">3.4.6</span> Tips</h4>
</div>

<div id="outline-container-org0306354" class="outline-4">
<h4 id="org0306354"><span class="section-number-4">3.4.7</span> Alternatives</h4>
</div>

<div id="outline-container-org05956f5" class="outline-4">
<h4 id="org05956f5"><span class="section-number-4">3.4.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-4-8">
<p>
sphericalbessely
</p>
</div>
</div>
</div>

<div id="outline-container-orgab97d9c" class="outline-3">
<h3 id="orgab97d9c"><span class="section-number-3">3.5</span> sphericalhankel</h3>
<div class="outline-text-3" id="text-3-5">
<p>
<a href="sphericalhankel.m">sphericalhankel.m</a>: returns the Bessel function of the 3rd kind (Hankel function)
</p>
</div>

<div id="outline-container-orga84f2ef" class="outline-4">
<h4 id="orga84f2ef"><span class="section-number-4">3.5.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-5-1">
<pre class="example">
h_OCF = sphericalhankel(n, x_CF)
</pre>
</div>
</div>

<div id="outline-container-orgf51bcb7" class="outline-4">
<h4 id="orgf51bcb7"><span class="section-number-4">3.5.2</span> Description</h4>
<div class="outline-text-4" id="text-3-5-2">
<p>
According to the mathematical definition, Hankel function is obtained be combining two linearly 
independent solutions of Bessel's differential equation (Wikipedia). This is done by means of 
summation spherical bessel function of the 1st kind with spherical bessel function of the 2nd kind,
multiplyed by the imaginary unit.
</p>

<p>
This calculation is done for all elements of the matrix x<sub>Cf</sub>
</p>
</div>
</div>

<div id="outline-container-org8463bc1" class="outline-4">
<h4 id="org8463bc1"><span class="section-number-4">3.5.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-5-3">
<ul class="org-ul">
<li>n - Ambisonics order</li>
<li>x<sub>CF</sub> -  matrix to return the result (should not have more than 2 dimensions)</li>
</ul>
</div>
</div>

<div id="outline-container-org834ea7f" class="outline-4">
<h4 id="org834ea7f"><span class="section-number-4">3.5.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-5-4">
<ul class="org-ul">
<li>h<sub>OCF</sub> - multi-dimensional matrix of calculation results</li>
</ul>
</div>
</div>

<div id="outline-container-orga03a0ea" class="outline-4">
<h4 id="orga03a0ea"><span class="section-number-4">3.5.5</span> Examples</h4>
</div>

<div id="outline-container-orge381629" class="outline-4">
<h4 id="orge381629"><span class="section-number-4">3.5.6</span> Tips</h4>
</div>

<div id="outline-container-org264d94e" class="outline-4">
<h4 id="org264d94e"><span class="section-number-4">3.5.7</span> Alternatives</h4>
</div>

<div id="outline-container-org5369bcf" class="outline-4">
<h4 id="org5369bcf"><span class="section-number-4">3.5.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-5-8">
<p>
sphericalbessel, sphericalneumann
</p>
</div>
</div>
</div>

<div id="outline-container-orga49e355" class="outline-3">
<h3 id="orga49e355"><span class="section-number-3">3.6</span> sphericalbessel<sub>r</sub></h3>
<div class="outline-text-3" id="text-3-6">
<p>
<a href="sphericalbessel_r.m">sphericalbessel_r.m</a>: returns the 1st radial derivative of the spherical Bessel function
</p>
<p>
<b>*</b> Syntax
</p>

<pre class="example">
J_r_OCF = sphericalbessel_r(N_order, x_CF)
</pre>



<p>
<b>*</b> Description
</p>

<p>
Similar with function sphericalbesselj, sphericalbessel<sub>r</sub> deals with the case when Ambisonics 
coefficients are given as a vector. 
</p>

<p>
<b>*</b> Input Arguments
</p>

<p>
N<sub>order</sub> - Ambisonics order
x<sub>CF</sub> -  matrix to return the result (should not have more than 2 dimensions)
</p>

<p>
<b>*</b> Return Values
</p>

<p>
J<sub>r</sub><sub>OCF</sub> - multi-dimensional matrix with Bessel function calculation results
</p>


<p>
<b>*</b> Examples
</p>

<p>
<b>*</b> Tips
</p>

<p>
<b>*</b> Alternatives
</p>

<p>
<b>*</b> See Also
</p>

<p>
sphericalbesseljr
</p>
</div>
</div>

<div id="outline-container-org1262d76" class="outline-3">
<h3 id="org1262d76"><span class="section-number-3">3.7</span> sphericalnormalisation</h3>
<div class="outline-text-3" id="text-3-7">
<p>
<code>sphericalnormalisation</code> - calculates the normalization factor 
<a href="./sphericalnormalisation.m">./sphericalnormalisation.m</a>
</p>
</div>

<div id="outline-container-org4dc3259" class="outline-4">
<h4 id="org4dc3259"><span class="section-number-4">3.7.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-7-1">
<pre class="example">
N_O = sphericalnormalisation(N_order, norm)
</pre>
</div>
</div>

<div id="outline-container-org49df515" class="outline-4">
<h4 id="org49df515"><span class="section-number-4">3.7.2</span> Description</h4>
<div class="outline-text-4" id="text-3-7-2">
<p>
Calculates the normalization factor for a given harmonic order and
normalization type.  If the type of normalization is not defined at
the output, full normalization 'norm' will be performed.
</p>
</div>
</div>

<div id="outline-container-org31c4fb2" class="outline-4">
<h4 id="org31c4fb2"><span class="section-number-4">3.7.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-7-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>order of a spherical harmonic</dd>
<dt>norm</dt><dd><p>
type of normalization: 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'norm'</td>
<td class="org-left">fully normalized;</td>
</tr>

<tr>
<td class="org-left">'N3D'</td>
<td class="org-left">normalized;</td>
</tr>

<tr>
<td class="org-left">'sch0' or 'SN3D'</td>
<td class="org-left">seminormalazed</td>
</tr>

<tr>
<td class="org-left">'sch1'</td>
<td class="org-left">Schmidt-Semi-normalized (Matlab)</td>
</tr>

<tr>
<td class="org-left">'sconv'</td>
<td class="org-left">norm. over all spherical convolutions</td>
</tr>

<tr>
<td class="org-left">'planewave<sub>impinging</sub>'</td>
<td class="org-left">norm. for plane waves</td>
</tr>
</tbody>
</table></dd>
</dl>
</div>
</div>

<div id="outline-container-orgc2c305c" class="outline-4">
<h4 id="orgc2c305c"><span class="section-number-4">3.7.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-7-4">
<ul class="org-ul">
<li>N<sub>O</sub> - corresponding normalization factor</li>
</ul>
</div>
</div>

<div id="outline-container-orgc9f4c0c" class="outline-4">
<h4 id="orgc9f4c0c"><span class="section-number-4">3.7.5</span> Examples</h4>
</div>
<div id="outline-container-org23661e6" class="outline-4">
<h4 id="org23661e6"><span class="section-number-4">3.7.6</span> Tips</h4>
</div>
<div id="outline-container-orga26226b" class="outline-4">
<h4 id="orga26226b"><span class="section-number-4">3.7.7</span> Alternatives</h4>
</div>
<div id="outline-container-org1c50592" class="outline-4">
<h4 id="org1c50592"><span class="section-number-4">3.7.8</span> See Also</h4>
</div>
</div>

<div id="outline-container-org5adef3c" class="outline-3">
<h3 id="org5adef3c"><span class="section-number-3">3.8</span> sphericallegendre</h3>
<div class="outline-text-3" id="text-3-8">
<p>
<a href="sphericallegendre.m">sphericallegendre.m</a>: calculates spherical Legendre functions
</p>
</div>

<div id="outline-container-org0d781e3" class="outline-4">
<h4 id="org0d781e3"><span class="section-number-4">3.8.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-8-1">
<pre class="example">
P_OA = sphericallegendre(N_order, theta_A)
</pre>
</div>
</div>

<div id="outline-container-org5e436ba" class="outline-4">
<h4 id="org5e436ba"><span class="section-number-4">3.8.2</span> Description</h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
Resulting matrix of Legendre function values has the dimensions ((N<sub>order</sub>+1)<sup>2</sup>+1)xlength(theta<sub>A</sub>).
For positive odd m a negative sign is used.
No normalization is used.
Regarding normalization the calculation is done for a symmetric calculation of m.
</p>

<ul class="org-ul">
<li>for \(m >= 0\): \(P_n^m(\cos(\theta )\)  [including \((-1)^m\)]</li>
<li>for \(m < 0:\)  \((-1)^m P_n^{|m|}(\cos(\theta )\)</li>
</ul>

<p>
equivalent to (using legendre polynomial notation without Condon-Shortley phase):
</p>
<ul class="org-ul">
<li>for \(m >= 0\): \((-1)^m P_n,|m|( \cos(\theta )\)</li>
<li>for \(m < 0\):  \(P_n,|m|( \cos(\theta )\)</li>
</ul>
</div>
</div>

<div id="outline-container-org704a8ce" class="outline-4">
<h4 id="org704a8ce"><span class="section-number-4">3.8.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-8-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>order of the spherical harmonic</dd>
<dt>theta<sub>A</sub></dt><dd>vector representing the calculation range of inclination theta</dd>
</dl>
</div>
</div>

<div id="outline-container-org86a99ce" class="outline-4">
<h4 id="org86a99ce"><span class="section-number-4">3.8.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-8-4">
<dl class="org-dl">
<dt>P<sub>OA</sub></dt><dd>matrix of Legendre function values</dd>
</dl>
</div>
</div>

<div id="outline-container-org91e4c37" class="outline-4">
<h4 id="org91e4c37"><span class="section-number-4">3.8.5</span> Examples</h4>
<div class="outline-text-4" id="text-3-8-5">
<p>
Legendre functions for \(n = 0, 1, 2, 3, 4, 5\) according to Figure 6.2
in <a class='org-ref-reference' href="#williams99_fourier_acoustic">williams99_fourier_acoustic</a> are shown by the following piece
of code.
</p>

<div class="org-src-container">
<pre class="src src-octave" id="orge299914">   N_order <span style="color: #00a6fb;">=</span> 5<span style="color: #00a6fb;">;</span>
   theta_A <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">,</span> 90)<span style="color: #00a6fb;">;</span>
   P_OA <span style="color: #00a6fb;">=</span> sphericallegendre(N_order<span style="color: #00a6fb;">,</span> theta_A)<span style="color: #00a6fb;">;</span>

   figure(1)<span style="color: #00a6fb;">;</span>
   n <span style="color: #00a6fb;">=</span> 0<span style="color: #00a6fb;">:</span>N_order<span style="color: #00a6fb;">;</span>
   m <span style="color: #00a6fb;">=</span> 0<span style="color: #00a6fb;">;</span>
   o <span style="color: #00a6fb;">=</span> n<span style="color: #00a6fb;">.^</span>2 <span style="color: #00a6fb;">+</span> n <span style="color: #00a6fb;">+</span> m <span style="color: #00a6fb;">+</span> 1<span style="color: #00a6fb;">;</span>
   <span style="color: #0082c9;">for</span> l <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>length(n)
     S_label{l} <span style="color: #00a6fb;">=</span> sprintf(<span style="color: #096b38;">'n = %i, m = %i'</span><span style="color: #00a6fb;">,</span> n(l)<span style="color: #00a6fb;">,</span> m)<span style="color: #00a6fb;">;</span>
   <span style="color: #0082c9;">end</span>
   plot(theta_A<span style="color: #00a6fb;">,</span> P_OA(o<span style="color: #00a6fb;">,:</span>))<span style="color: #00a6fb;">;</span> xlabel(<span style="color: #096b38;">'\theta'</span>)<span style="color: #00a6fb;">;</span> ylabel(<span style="color: #096b38;">'P_{n}(\theta)'</span>)<span style="color: #00a6fb;">;</span> legend(S_label)<span style="color: #00a6fb;">;</span>
   S_file <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'img/legendrefigure62.png'</span><span style="color: #00a6fb;">;</span> saveas(1<span style="color: #00a6fb;">,</span> S_file)<span style="color: #00a6fb;">;</span>
   ans <span style="color: #00a6fb;">=</span> S_file<span style="color: #00a6fb;">;</span>
</pre>
</div>


<div id="orgc584c98" class="figure">
<p><img src="img/legendrefigure62.png" alt="legendrefigure62.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Legendre functions for \(n = 0, 1, 2, 3, 4, 5\) and \(m=0\).</p>
</div>

<p>
Legendre functions for \(n = 1, 2, 3, 4, 5, 6\) according to Figure 6.3
in <a class='org-ref-reference' href="#williams99_fourier_acoustic">williams99_fourier_acoustic</a> are shown by the following piece
of code.
</p>

<div class="org-src-container">
<pre class="src src-octave" id="org5c0bc18">   N_order <span style="color: #00a6fb;">=</span> 6<span style="color: #00a6fb;">;</span>
   theta_A <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">,</span> 90)<span style="color: #00a6fb;">;</span>
   P_OA <span style="color: #00a6fb;">=</span> sphericallegendre(N_order<span style="color: #00a6fb;">,</span> theta_A)<span style="color: #00a6fb;">;</span>

   figure(1)<span style="color: #00a6fb;">;</span>
   n <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>N_order<span style="color: #00a6fb;">;</span>
   m <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>
   o <span style="color: #00a6fb;">=</span> n<span style="color: #00a6fb;">.^</span>2 <span style="color: #00a6fb;">+</span> n <span style="color: #00a6fb;">+</span> m <span style="color: #00a6fb;">+</span> 1<span style="color: #00a6fb;">;</span>
   <span style="color: #0082c9;">for</span> l <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>length(n)
     S_label{l} <span style="color: #00a6fb;">=</span> sprintf(<span style="color: #096b38;">'n = %i, m = %i'</span><span style="color: #00a6fb;">,</span> n(l)<span style="color: #00a6fb;">,</span> m)<span style="color: #00a6fb;">;</span>
   <span style="color: #0082c9;">end</span>
   plot(theta_A<span style="color: #00a6fb;">,</span> P_OA(o<span style="color: #00a6fb;">,:</span>))<span style="color: #00a6fb;">;</span> xlabel(<span style="color: #096b38;">'\theta'</span>)<span style="color: #00a6fb;">;</span> ylabel(<span style="color: #096b38;">'P_{n}^m(\theta)'</span>)<span style="color: #00a6fb;">;</span> legend(S_label)<span style="color: #00a6fb;">;</span>
   S_file <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'img/legendrefigure63.png'</span><span style="color: #00a6fb;">;</span> saveas(1<span style="color: #00a6fb;">,</span> S_file)<span style="color: #00a6fb;">;</span>
   ans <span style="color: #00a6fb;">=</span> S_file<span style="color: #00a6fb;">;</span>
</pre>
</div>

<div id="org35a8667" class="figure">
<p><img src="img/legendrefigure63.png" alt="legendrefigure63.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-orga0ad906" class="outline-4">
<h4 id="orga0ad906"><span class="section-number-4">3.8.6</span> See Also</h4>
<div class="outline-text-4" id="text-3-8-6">
<p>
legendre 
</p>
</div>
</div>
</div>

<div id="outline-container-orgcdf0570" class="outline-3">
<h3 id="orgcdf0570"><span class="section-number-3">3.9</span> trg</h3>
<div class="outline-text-3" id="text-3-9">
<p>
<a href="trg.m">trg.m</a>: calculates something for given argument
</p>
</div>

<div id="outline-container-org8edb7a9" class="outline-4">
<h4 id="org8edb7a9"><span class="section-number-4">3.9.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-9-1">
<pre class="example">
y = trg(m, x)
</pre>
</div>
</div>
<div id="outline-container-org9d0be4f" class="outline-4">
<h4 id="org9d0be4f"><span class="section-number-4">3.9.2</span> Description</h4>
</div>

<div id="outline-container-org5910847" class="outline-4">
<h4 id="org5910847"><span class="section-number-4">3.9.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-9-3">
<ul class="org-ul">
<li>x : numeric argument</li>
<li>m : order</li>
</ul>
</div>
</div>

<div id="outline-container-org4e4abb0" class="outline-4">
<h4 id="org4e4abb0"><span class="section-number-4">3.9.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-9-4">
<p>
y
</p>
</div>
</div>

<div id="outline-container-org5dadf33" class="outline-4">
<h4 id="org5dadf33"><span class="section-number-4">3.9.5</span> Examples</h4>
</div>
<div id="outline-container-org745a30b" class="outline-4">
<h4 id="org745a30b"><span class="section-number-4">3.9.6</span> Tips</h4>
</div>
<div id="outline-container-orgb64e937" class="outline-4">
<h4 id="orgb64e937"><span class="section-number-4">3.9.7</span> Alternatives</h4>
</div>
<div id="outline-container-org5077924" class="outline-4">
<h4 id="org5077924"><span class="section-number-4">3.9.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-9-8">
<p>
trh
</p>
</div>
</div>
</div>

<div id="outline-container-org1684aa1" class="outline-3">
<h3 id="org1684aa1"><span class="section-number-3">3.10</span> trh</h3>
<div class="outline-text-3" id="text-3-10">
<p>
<a href="trh.m">trh.m</a>: calculates something for given argument
</p>
</div>

<div id="outline-container-org39b2008" class="outline-4">
<h4 id="org39b2008"><span class="section-number-4">3.10.1</span> Syntax</h4>
</div>
<div id="outline-container-org58954a8" class="outline-4">
<h4 id="org58954a8"><span class="section-number-4">3.10.2</span> Description</h4>
<div class="outline-text-4" id="text-3-10-2">
<p>
real-valued circular harmonics 2D normalised (N2D) of degree m and azimuth x
</p>

<p>
2D normalised (N2D) as defined in sec. 3.1 of
</p>
<ol class="org-ol">
<li>Daniel:</li>
</ol>
<p>
Spatial Sound Endcoding Including Near Field Effect: Introducing Distance 
coding Filters and a Viable, New Ambisonic Format, 
AES 23rd International Conference, 2003
</p>
</div>
</div>

<div id="outline-container-org8cea8cf" class="outline-4">
<h4 id="org8cea8cf"><span class="section-number-4">3.10.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-10-3">
<dl class="org-dl">
<dt>m</dt><dd>degree</dd>
<dt>x</dt><dd>azimuth</dd>
</dl>
</div>
</div>

<div id="outline-container-orgc944d4f" class="outline-4">
<h4 id="orgc944d4f"><span class="section-number-4">3.10.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-10-4">
<dl class="org-dl">
<dt>y</dt><dd>circular harmonic</dd>
</dl>
</div>
</div>

<div id="outline-container-org3f28504" class="outline-4">
<h4 id="org3f28504"><span class="section-number-4">3.10.5</span> Examples</h4>
</div>
<div id="outline-container-orgabb00dc" class="outline-4">
<h4 id="orgabb00dc"><span class="section-number-4">3.10.6</span> Tips</h4>
</div>
<div id="outline-container-org41ceb55" class="outline-4">
<h4 id="org41ceb55"><span class="section-number-4">3.10.7</span> Alternatives</h4>
</div>
<div id="outline-container-org65191f7" class="outline-4">
<h4 id="org65191f7"><span class="section-number-4">3.10.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-10-8">
<p>
trh
</p>
</div>
</div>
</div>

<div id="outline-container-org98c3e13" class="outline-3">
<h3 id="org98c3e13"><span class="section-number-3">3.11</span> sphericalazimuth</h3>
<div class="outline-text-3" id="text-3-11">
<p>
<a href="sphericalazimuth.m">sphericalazimuth.m</a>: calculates spherical azimuth of order N for angle phi 
</p>
</div>

<div id="outline-container-org857c7eb" class="outline-4">
<h4 id="org857c7eb"><span class="section-number-4">3.11.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-11-1">
<pre class="example">
D_OB = sphericalazimuth(N_order, phi_B, S_type)
</pre>
</div>
</div>

<div id="outline-container-orgc09dcec" class="outline-4">
<h4 id="orgc09dcec"><span class="section-number-4">3.11.2</span> Description</h4>
<div class="outline-text-4" id="text-3-11-2">
<p>
spherical azimuth of order N for angle phi 
</p>

<p>
If less than 3 variablrs are defined at the input, calculation is done
for S<sub>type</sub> = 'complex' case.
</p>
</div>
</div>

<div id="outline-container-orgf4484ec" class="outline-4">
<h4 id="orgf4484ec"><span class="section-number-4">3.11.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-11-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>order of the spherical harmonic</dd>
<dt>phi<sub>B</sub></dt><dd>vector representing the calculation range of azimuth phi ?</dd>
<dt>S<sub>type</sub></dt><dd>type of the spherical harmonic: 'real', 'real<sub>signed</sub>', 'real<sub>unsigned</sub>'  or 'complex'</dd>
</dl>
</div>
</div>

<div id="outline-container-org34e226d" class="outline-4">
<h4 id="org34e226d"><span class="section-number-4">3.11.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-11-4">
<dl class="org-dl">
<dt>D<sub>OB</sub></dt><dd>matrix with o orders and B angles</dd>
</dl>
</div>
</div>

<div id="outline-container-org3efe74d" class="outline-4">
<h4 id="org3efe74d"><span class="section-number-4">3.11.5</span> Examples</h4>
<div class="outline-text-4" id="text-3-11-5">

<div id="org6f0a0d1" class="figure">
<p><img src="img/sphericalazimuth.png" alt="sphericalazimuth.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgeecf8aa" class="outline-4">
<h4 id="orgeecf8aa"><span class="section-number-4">3.11.6</span> Tips</h4>
</div>
<div id="outline-container-orga36db29" class="outline-4">
<h4 id="orga36db29"><span class="section-number-4">3.11.7</span> Alternatives</h4>
</div>
<div id="outline-container-org98d0322" class="outline-4">
<h4 id="org98d0322"><span class="section-number-4">3.11.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-11-8">
<p>
trg, trh
</p>
</div>
</div>
</div>

<div id="outline-container-orgdfa86aa" class="outline-3">
<h3 id="orgdfa86aa"><span class="section-number-3">3.12</span> sphericalharmonic</h3>
<div class="outline-text-3" id="text-3-12">
<p>
<a href="sphericalharmonic.m">sphericalharmonic.m</a>: returns a spherical harmonic of given order,
type and normalization
</p>
</div>

<div id="outline-container-org385f9fd" class="outline-4">
<h4 id="org385f9fd"><span class="section-number-4">3.12.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-12-1">
<pre class="example">
Y_OAB = sphericalharmonic(N_order, theta_A, phi_B, norm, type)
</pre>
</div>
</div>
<div id="outline-container-orgaaf26ab" class="outline-4">
<h4 id="orgaaf26ab"><span class="section-number-4">3.12.2</span> Description</h4>
<div class="outline-text-4" id="text-3-12-2">
<p>
If the number of input arguments is &lt; 5, the calculation would be done
for a 'complex' type of a spherical harmonic. If the number of input
arguments is &lt; 4, the calculation would be done for a 'norm'
normalization type case.
</p>

<p>
Harmonics are returned in rows of p (e.g. row = 1 -&gt; m = 0, row = 2 -&gt;
m = 1) after e.g. Poletti.
</p>
</div>
</div>

<div id="outline-container-org7840310" class="outline-4">
<h4 id="org7840310"><span class="section-number-4">3.12.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-12-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>Ambisonics order</dd>
<dt>theta<sub>A</sub></dt><dd>vector representing the calculation range of inclination theta</dd>
<dt>phi<sub>B</sub></dt><dd>vector representing the calculation range of azimuth phi</dd>
<dt>norm</dt><dd><p>
string with type of normalization: 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'norm'</td>
<td class="org-left">fully normalized</td>
</tr>

<tr>
<td class="org-left">'N3D'</td>
<td class="org-left">normalized</td>
</tr>

<tr>
<td class="org-left">'sch0' or 'SN3D'</td>
<td class="org-left">seminormalazed</td>
</tr>

<tr>
<td class="org-left">'sch1'</td>
<td class="org-left">Schmidt-Semi-normalized (Matlab(tm))</td>
</tr>

<tr>
<td class="org-left">'sconv'</td>
<td class="org-left">norm. over all spherical convolutions</td>
</tr>

<tr>
<td class="org-left">'planewave<sub>impinging</sub>'</td>
<td class="org-left">norm. for plane waves</td>
</tr>
</tbody>
</table></dd>
<dt>type</dt><dd><p>
type of the spherical harmonic: 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'real', 'real<sub>signed</sub>', 'real<sub>unsigned</sub>'  or 'complex'</td>
</tr>
</tbody>
</table></dd>
</dl>
</div>
</div>
<div id="outline-container-orgbf9c76c" class="outline-4">
<h4 id="orgbf9c76c"><span class="section-number-4">3.12.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-12-4">
<dl class="org-dl">
<dt>Y<sub>OAB</sub></dt><dd>matrix of the spherical harmonics values</dd>
</dl>
</div>
</div>

<div id="outline-container-org4d83674" class="outline-4">
<h4 id="org4d83674"><span class="section-number-4">3.12.5</span> Examples</h4>
<div class="outline-text-4" id="text-3-12-5">

<div id="org6c1d916" class="figure">
<p><img src="img/sphereharmsurf.png" alt="sphereharmsurf.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Spherical harmonic functions shown as functions of the radius.</p>
</div>
</div>
</div>

<div id="outline-container-org73f66f7" class="outline-4">
<h4 id="org73f66f7"><span class="section-number-4">3.12.6</span> Tips</h4>
</div>
<div id="outline-container-org2070c5e" class="outline-4">
<h4 id="org2070c5e"><span class="section-number-4">3.12.7</span> Alternatives</h4>
</div>
<div id="outline-container-org499c013" class="outline-4">
<h4 id="org499c013"><span class="section-number-4">3.12.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-12-8">
<p>
sphericalnormalisation, sphericallegendre, sphericalazimuth
</p>
</div>
</div>
</div>

<div id="outline-container-orgdad862c" class="outline-3">
<h3 id="orgdad862c"><span class="section-number-3">3.13</span> sphericalmodematrix</h3>
<div class="outline-text-3" id="text-3-13">
<p>
<a href="sphericalmodematrix.m">sphericalmodematrix.m</a>: calculates something for given argument
</p>
</div>


<div id="outline-container-org0838e15" class="outline-4">
<h4 id="org0838e15"><span class="section-number-4">3.13.1</span> Syntax</h4>
<div class="outline-text-4" id="text-3-13-1">
<pre class="example">
Psi_OL = sphericalmodematrix(N_order, theta_L, phi_L, S_norm, S_type)
</pre>



<p>
% \(Id\)
</p>
</div>
</div>
<div id="outline-container-org5de07c3" class="outline-4">
<h4 id="org5de07c3"><span class="section-number-4">3.13.2</span> Description</h4>
<div class="outline-text-4" id="text-3-13-2">
<p>
sphericalmodematrix - returns Ambisonics complex conjugate values
</p>
</div>
</div>

<div id="outline-container-org1c6a728" class="outline-4">
<h4 id="org1c6a728"><span class="section-number-4">3.13.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-3-13-3">
<ul class="org-ul">
<li>N<sub>order</sub> -  Ambisonics order</li>
<li>theta<sub>L</sub> - vector representing the calculation range of inclination theta</li>
<li>phi<sub>L</sub> - vector representing the calculation range of azimuth phi</li>
<li>S<sub>norm</sub> - string with type of normalization: 'norm' - fully normalized; 
'N3D'- normalized; 
'sch0' or 'SN3D'- seminormalazed
'sch1'- Schmidt-Semi-normalized (Matlab)
'sconv' - norm. over all spherical convolutions
'planewave<sub>impinging</sub>' - norm. for plane waves</li>
</ul>
</div>
</div>

<div id="outline-container-org870f696" class="outline-4">
<h4 id="org870f696"><span class="section-number-4">3.13.4</span> Return Values</h4>
<div class="outline-text-4" id="text-3-13-4">
<ul class="org-ul">
<li>Psi<sub>OL</sub> - matrix of complex conjugate spherical harmonics values</li>
</ul>
</div>
</div>

<div id="outline-container-org76514c4" class="outline-4">
<h4 id="org76514c4"><span class="section-number-4">3.13.5</span> Examples</h4>
</div>

<div id="outline-container-org4b0ec21" class="outline-4">
<h4 id="org4b0ec21"><span class="section-number-4">3.13.6</span> Tips</h4>
</div>

<div id="outline-container-org7a90fb4" class="outline-4">
<h4 id="org7a90fb4"><span class="section-number-4">3.13.7</span> Alternatives</h4>
</div>

<div id="outline-container-org969e7de" class="outline-4">
<h4 id="org969e7de"><span class="section-number-4">3.13.8</span> See Also</h4>
<div class="outline-text-4" id="text-3-13-8">
<p>
sphericalharmonic
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org9838a67" class="outline-2">
<h2 id="org9838a67"><span class="section-number-2">4</span> Spherical Fourier Transform</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org45c4966" class="outline-3">
<h3 id="org45c4966"><span class="section-number-3">4.1</span> sphericalseries<sub>isfs</sub></h3>
<div class="outline-text-3" id="text-4-1">
<p>
<a href="sphericalseries_isfs.m">sphericalseries_isfs.m</a>: calculate spherical series functions summands
</p>
</div>

<div id="outline-container-org7d22960" class="outline-4">
<h4 id="org7d22960"><span class="section-number-4">4.1.1</span> Syntax</h4>
<div class="outline-text-4" id="text-4-1-1">
<pre class="example">
F_OCABF = sphericalseries_isfs(f_OCF, Y_OAB)
</pre>
</div>
</div>

<div id="outline-container-org97acfa6" class="outline-4">
<h4 id="org97acfa6"><span class="section-number-4">4.1.2</span> Description</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
precalculation of ISF
</p>
</div>
</div>

<div id="outline-container-org48d6262" class="outline-4">
<h4 id="org48d6262"><span class="section-number-4">4.1.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-4-1-3">
<dl class="org-dl">
<dt>f<sub>OCF</sub></dt><dd>spherical fourier series coefficient</dd>
<dt>Y<sub>OAB</sub></dt><dd>spherical harmonics</dd>
</dl>
</div>
</div>

<div id="outline-container-org438e8a1" class="outline-4">
<h4 id="org438e8a1"><span class="section-number-4">4.1.4</span> Return Values</h4>
<div class="outline-text-4" id="text-4-1-4">
<dl class="org-dl">
<dt>F<sub>OCABF</sub></dt><dd>intermediate result</dd>
</dl>
</div>
</div>

<div id="outline-container-org8867615" class="outline-4">
<h4 id="org8867615"><span class="section-number-4">4.1.5</span> Examples</h4>
</div>

<div id="outline-container-org71e8315" class="outline-4">
<h4 id="org71e8315"><span class="section-number-4">4.1.6</span> Tips</h4>
</div>

<div id="outline-container-orgc0b42b2" class="outline-4">
<h4 id="orgc0b42b2"><span class="section-number-4">4.1.7</span> Alternatives</h4>
</div>

<div id="outline-container-org7e14e95" class="outline-4">
<h4 id="org7e14e95"><span class="section-number-4">4.1.8</span> See Also</h4>
</div>
</div>


<div id="outline-container-orgc0c9da0" class="outline-3">
<h3 id="orgc0c9da0"><span class="section-number-3">4.2</span> sphericalseries<sub>isf</sub></h3>
<div class="outline-text-3" id="text-4-2">
<p>
<a href="sphericalseries_isf.m">sphericalseries_isf.m</a>: calculates something for given argument
</p>
<p>
<b>*</b> Syntax
</p>

<p>
<b>*</b> Description
</p>

<p>
<b>*</b> Input Arguments
</p>

<p>
<b>*</b> Return Values
</p>

<p>
<b>*</b> Examples
</p>

<p>
<b>*</b> Tips
</p>

<p>
<b>*</b> Alternatives
</p>

<p>
<b>*</b> See Also
</p>
</div>
</div>


<div id="outline-container-org1522790" class="outline-3">
<h3 id="org1522790"><span class="section-number-3">4.3</span> sphericalseries<sub>sfc</sub></h3>
<div class="outline-text-3" id="text-4-3">
<p>
<a href="sphericalseries_sfc.m">sphericalseries_sfc.m</a>: returns the coefficients of spherical Fourier transform 
</p>
</div>

<div id="outline-container-orge7cdace" class="outline-4">
<h4 id="orge7cdace"><span class="section-number-4">4.3.1</span> Syntax</h4>
<div class="outline-text-4" id="text-4-3-1">
<pre class="example">
C_OCFD = sphericalseries_sfc(A_OFD, B_OFD, r_C, R_src, k_F)
</pre>
</div>
</div>


<div id="outline-container-org9127ad9" class="outline-4">
<h4 id="org9127ad9"><span class="section-number-4">4.3.2</span> Description</h4>
</div>

<div id="outline-container-org65fb6c3" class="outline-4">
<h4 id="org65fb6c3"><span class="section-number-4">4.3.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-4-3-3">
<ul class="org-ul">
<li>A<sub>OFD</sub> - matrix of HOA coefficients</li>
<li>B<sub>OFD</sub> - matrix of HOA coefficients</li>
<li>r<sub>C</sub> - radius ???</li>
<li>R<sub>src</sub> - source radius</li>
<li>k<sub>F</sub> - vector of a wave number values for a given frequency range</li>
</ul>
</div>
</div>

<div id="outline-container-org50e7f04" class="outline-4">
<h4 id="org50e7f04"><span class="section-number-4">4.3.4</span> Return Values</h4>
<div class="outline-text-4" id="text-4-3-4">
<ul class="org-ul">
<li>C<sub>OCFD</sub> - multi-dimensional matrix of the spherical FT coefficients</li>
</ul>
</div>
</div>

<div id="outline-container-org7ecdd63" class="outline-4">
<h4 id="org7ecdd63"><span class="section-number-4">4.3.5</span> Examples</h4>
</div>

<div id="outline-container-org040b188" class="outline-4">
<h4 id="org040b188"><span class="section-number-4">4.3.6</span> Tips</h4>
</div>

<div id="outline-container-org40102be" class="outline-4">
<h4 id="org40102be"><span class="section-number-4">4.3.7</span> Alternatives</h4>
</div>

<div id="outline-container-orgf55fc33" class="outline-4">
<h4 id="orgf55fc33"><span class="section-number-4">4.3.8</span> See Also</h4>
<div class="outline-text-4" id="text-4-3-8">
<p>
sphericalbessel, sphericalhankel
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4d9a43c" class="outline-2">
<h2 id="org4d9a43c"><span class="section-number-2">5</span> Higher Order Ambisonics</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org0c8015b" class="outline-3">
<h3 id="org0c8015b"><span class="section-number-3">5.1</span> Sphericalseries<sub>hoa</sub></h3>
<div class="outline-text-3" id="text-5-1">
<p>
<a href="sphericalseries_hoa.m">sphericalseries_hoa.m</a>: returns result of HOA series
</p>
<p>
<b>*</b> Syntax
</p>

<pre class="example">
p_CABF = sphericalseries_hoa(C_OF, F_OCABF, D_OF, G_OCABF)
</pre>


<p>
<b>*</b> Description
</p>

<p>
Returns result of HOA series with coefficients C and D and basis functions F and G. 
The second pair (D and G) is optional.
The matrix of basis function should have at least 3 dimensions.
</p>

<p>
<b>*</b> Input Arguments
</p>

<dl class="org-dl">
<dt>C<sub>OF</sub></dt><dd>???????</dd>
<dt>F<sub>OCABF</sub></dt><dd>basis function values matrix</dd>
<dt>D<sub>OF</sub></dt><dd>??????</dd>
<dt>G<sub>OCABF</sub></dt><dd>basis function values matrix</dd>
</dl>

<p>
<b>*</b> Return Values
</p>

<p>
<b>*</b> Examples
</p>

<p>
<b>*</b> Tips
</p>

<p>
<b>*</b> Alternatives
</p>

<p>
<b>*</b> See Also
</p>
</div>
</div>

<div id="outline-container-orge48bdde" class="outline-3">
<h3 id="orge48bdde"><span class="section-number-3">5.2</span> Sphericalseries<sub>hoa</sub><sub>plane</sub></h3>
<div class="outline-text-3" id="text-5-2">
<p>
<a href="sphericalseries_hoa_plane.m">sphericalseries_hoa_plane.m</a>: calculates plane wave coefficients \(A\) for a HOA representation.
</p>
</div>

<div id="outline-container-org7768a85" class="outline-4">
<h4 id="org7768a85"><span class="section-number-4">5.2.1</span> Syntax</h4>
<div class="outline-text-4" id="text-5-2-1">
<pre class="example">
A_OFD = sphericalseries_hoa_plane(N_order, theta_D, phi_D, S_norm, S_type, F, psi_D)
</pre>
</div>
</div>

<div id="outline-container-orgfe0b188" class="outline-4">
<h4 id="orgfe0b188"><span class="section-number-4">5.2.2</span> Description</h4>
<div class="outline-text-4" id="text-5-2-2">
<p>
calculates plane wave coefficients \(A\) for a HOA representation.
</p>
</div>
</div>

<div id="outline-container-org9f86705" class="outline-4">
<h4 id="org9f86705"><span class="section-number-4">5.2.3</span> Input Arguments</h4>
<div class="outline-text-4" id="text-5-2-3">
<dl class="org-dl">
<dt>N<sub>order</sub></dt><dd>Ambisonics order</dd>
<dt>theta<sub>D</sub></dt><dd>vector representing the calculation range of inclination theta</dd>
<dt>phi<sub>D</sub></dt><dd>vector representing the calculation range of azimuth phi</dd>
<dt>S<sub>norm</sub></dt><dd><p>
string with type of normalization: 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">'norm'</td>
<td class="org-left">fully normalized;</td>
</tr>

<tr>
<td class="org-left">'N3D'</td>
<td class="org-left">normalized;</td>
</tr>

<tr>
<td class="org-left">'sch0' or 'SN3D'</td>
<td class="org-left">seminormalazed</td>
</tr>

<tr>
<td class="org-left">'sch1'</td>
<td class="org-left">Schmidt-Semi-normalized (Matlab)</td>
</tr>

<tr>
<td class="org-left">'sconv'</td>
<td class="org-left">norm. over all spherical convolutions</td>
</tr>

<tr>
<td class="org-left">'planewave<sub>impinging</sub>'</td>
<td class="org-left">norm. for plane waves</td>
</tr>
</tbody>
</table></dd>
<dt>S<sub>type</sub></dt><dd>type of the spherical harmonic: 'real', 'real<sub>signed</sub>', 'real<sub>unsigned</sub>'  or 'complex'</dd>
<dt>F</dt><dd>number of frequency bins (having all the same value)</dd>
<dt>psi<sub>D</sub></dt><dd>weights for D input direction (optional argument)</dd>
</dl>
</div>
</div>

<div id="outline-container-orgf4136e7" class="outline-4">
<h4 id="orgf4136e7"><span class="section-number-4">5.2.4</span> Return Values</h4>
<div class="outline-text-4" id="text-5-2-4">
<dl class="org-dl">
<dt>A<sub>OFD</sub></dt><dd>matrix of HOA coefficients</dd>
</dl>
</div>
</div>

<div id="outline-container-orga7d1380" class="outline-4">
<h4 id="orga7d1380"><span class="section-number-4">5.2.5</span> Examples</h4>
</div>

<div id="outline-container-orgce2b0bd" class="outline-4">
<h4 id="orgce2b0bd"><span class="section-number-4">5.2.6</span> Tips</h4>
</div>

<div id="outline-container-orga918ccd" class="outline-4">
<h4 id="orga918ccd"><span class="section-number-4">5.2.7</span> Alternatives</h4>
</div>

<div id="outline-container-org5fd9d07" class="outline-4">
<h4 id="org5fd9d07"><span class="section-number-4">5.2.8</span> See Also</h4>
<div class="outline-text-4" id="text-5-2-8">
<p>
sphericalnormalisation, sphericalmodematrix
</p>

<div class="org-src-container">
<pre class="src src-octave" id="orgf228449"><span style="color: #8b9985;">% </span><span style="color: #8b9985;">Rasta</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">conus</span>
<span style="color: #0082c9;">if</span> 0
  R_max <span style="color: #00a6fb;">=</span> 1.5<span style="color: #00a6fb;">;</span>
  C <span style="color: #00a6fb;">=</span> 50<span style="color: #00a6fb;">;</span> r_C <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> R_max<span style="color: #00a6fb;">,</span> C)<span style="color: #00a6fb;">;</span>
  A <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>  theta_A <span style="color: #00a6fb;">=</span> linspace(pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> A)<span style="color: #00a6fb;">;</span>
  B <span style="color: #00a6fb;">=</span> 50<span style="color: #00a6fb;">;</span> phi_B <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> 2<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">,</span>    B)<span style="color: #00a6fb;">;</span>
  gg_CAB <span style="color: #00a6fb;">=</span> vectorgrid(r_C<span style="color: #00a6fb;">,</span> theta_A<span style="color: #00a6fb;">,</span> phi_B<span style="color: #00a6fb;">,</span> <span style="color: #096b38;">'spherical'</span>)<span style="color: #00a6fb;">;</span>
<span style="color: #0082c9;">end</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">sphere</span>
<span style="color: #0082c9;">if</span> 1
  R_max <span style="color: #00a6fb;">=</span> .15<span style="color: #00a6fb;">;</span>
  C <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span> r_C <span style="color: #00a6fb;">=</span> linspace(R_max<span style="color: #00a6fb;">,</span> R_max<span style="color: #00a6fb;">,</span> C)<span style="color: #00a6fb;">;</span>
  A <span style="color: #00a6fb;">=</span> 30<span style="color: #00a6fb;">;</span>  theta_A <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">,</span> A)<span style="color: #00a6fb;">;</span>
  B <span style="color: #00a6fb;">=</span> 40<span style="color: #00a6fb;">;</span> phi_B <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> 2<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">,</span>  B)<span style="color: #00a6fb;">;</span>
  gg_CAB <span style="color: #00a6fb;">=</span> vectorgrid(r_C<span style="color: #00a6fb;">,</span> theta_A<span style="color: #00a6fb;">,</span> phi_B<span style="color: #00a6fb;">,</span> <span style="color: #096b38;">'spherical'</span>)<span style="color: #00a6fb;">;</span>
<span style="color: #0082c9;">end</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Spherical stuff</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
N_order <span style="color: #00a6fb;">=</span> 7<span style="color: #00a6fb;">;</span>
F <span style="color: #00a6fb;">=</span> 4<span style="color: #00a6fb;">;</span>
f_F <span style="color: #00a6fb;">=</span> linspace(100<span style="color: #00a6fb;">,</span> 1000<span style="color: #00a6fb;">,</span> F)<span style="color: #00a6fb;">;</span> <span style="color: #8b9985;">% Frequenzen</span>
k_F <span style="color: #00a6fb;">=</span> <span style="color: #00a6fb;">-</span>2<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">*</span>f_F<span style="color: #00a6fb;">/</span>342<span style="color: #00a6fb;">;</span> <span style="color: #8b9985;">% Wellenzahl</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">ebene Welle</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
Theta_i <span style="color: #00a6fb;">=</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">;</span>
Phi_i <span style="color: #00a6fb;">=</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">;</span>
S_norm <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'norm'</span><span style="color: #00a6fb;">;</span>
S_type <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'complex'</span><span style="color: #00a6fb;">;</span>
A_OF <span style="color: #00a6fb;">=</span> sphericalseries_hoa_plane(N_order<span style="color: #00a6fb;">,</span> Theta_i<span style="color: #00a6fb;">,</span> Phi_i<span style="color: #00a6fb;">,</span> <span style="color: #00a6fb;">...</span>
                                 S_norm<span style="color: #00a6fb;">,</span> S_type<span style="color: #00a6fb;">,</span> F)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Sph&#228;rische-Fouriertransformations-Coeffizienten (sfc)</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
C_OCF <span style="color: #00a6fb;">=</span> sphericalseries_sfc(A_OF<span style="color: #00a6fb;">,</span> []<span style="color: #00a6fb;">,</span> r_C<span style="color: #00a6fb;">,</span> inf<span style="color: #00a6fb;">,</span> k_F)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">inverse sph&#228;rische Fouriertransformation (isf)</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Basisfunktion</span>
Y_OAB <span style="color: #00a6fb;">=</span> sphericalharmonic(N_order<span style="color: #00a6fb;">,</span> theta_A<span style="color: #00a6fb;">,</span> phi_B<span style="color: #00a6fb;">,</span> S_norm<span style="color: #00a6fb;">,</span> S_type)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">ISF im Frequenzbereich</span>
P_CABF <span style="color: #00a6fb;">=</span> sphericalseries_isf(C_OCF<span style="color: #00a6fb;">,</span> Y_OAB)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">malen</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
<span style="color: #0082c9;">if</span> 1
  <span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
    figure(f)<span style="color: #00a6fb;">;</span>
    surface(gg_CAB<span style="color: #00a6fb;">,</span> squeeze(abs(real(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f)))))<span style="color: #00a6fb;">;</span>
    axis(<span style="color: #096b38;">'equal'</span>)<span style="color: #00a6fb;">;</span>
    grid(<span style="color: #096b38;">'on'</span>)<span style="color: #00a6fb;">;</span>
    view([30 40])<span style="color: #00a6fb;">;</span>
  <span style="color: #0082c9;">end</span>
<span style="color: #0082c9;">end</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7cc0e69" class="outline-3">
<h3 id="org7cc0e69"><span class="section-number-3">5.3</span> sphericalseries<sub>hoa</sub><sub>spherical</sub></h3>
</div>
<div id="outline-container-org6400760" class="outline-3">
<h3 id="org6400760"><span class="section-number-3">5.4</span> sphericalseries<sub>hoa</sub><sub>basis</sub></h3>
<div class="outline-text-3" id="text-5-4">
<p>
<a href="sphericalseries_hoa_basis.m">sphericalseries_hoa_basis.m</a>: returns spherical basis functions R = j<sub>n</sub> Y and S = h<sub>n</sub> Y
</p>
</div>

<div id="outline-container-orgce49fab" class="outline-4">
<h4 id="orgce49fab"><span class="section-number-4">5.4.1</span> Syntax</h4>
</div>

<div id="outline-container-orgb417f91" class="outline-4">
<h4 id="orgb417f91"><span class="section-number-4">5.4.2</span> Description</h4>
<div class="outline-text-4" id="text-5-4-2">
<pre class="example">
[R_OCABF, S_OCABF] = sphericalseries_hoa_basis(N_order, R_src, ...
                                           vg_CAB, k_F, ...
                                           S_norm, S_type)
</pre>


<p>
returns spherical basis functions R = j<sub>n</sub> Y and S = h<sub>n</sub> Y
</p>
</div>
</div>

<div id="outline-container-org831066b" class="outline-4">
<h4 id="org831066b"><span class="section-number-4">5.4.3</span> Input Arguments</h4>
</div>

<div id="outline-container-org682a674" class="outline-4">
<h4 id="org682a674"><span class="section-number-4">5.4.4</span> Return Values</h4>
</div>

<div id="outline-container-org7da69c5" class="outline-4">
<h4 id="org7da69c5"><span class="section-number-4">5.4.5</span> Examples</h4>
</div>

<div id="outline-container-org584dbca" class="outline-4">
<h4 id="org584dbca"><span class="section-number-4">5.4.6</span> Tips</h4>
</div>

<div id="outline-container-orgf1ecf6b" class="outline-4">
<h4 id="orgf1ecf6b"><span class="section-number-4">5.4.7</span> Alternatives</h4>
</div>

<div id="outline-container-org92503b5" class="outline-4">
<h4 id="org92503b5"><span class="section-number-4">5.4.8</span> See Also</h4>
</div>
</div>

<div id="outline-container-org05ca26a" class="outline-3">
<h3 id="org05ca26a"><span class="section-number-3">5.5</span> sphericalseries<sub>sfc</sub></h3>
</div>
</div>
<div id="outline-container-orgce878ac" class="outline-2">
<h2 id="orgce878ac"><span class="section-number-2">6</span> Examples</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orgfe879d5" class="outline-3">
<h3 id="orgfe879d5"><span class="section-number-3">6.1</span> Plane wave</h3>
<div class="outline-text-3" id="text-6-1">
<p>
Grid for space
</p>

<div class="org-src-container">
<pre class="src src-octave" id="org7d0f8d8"><span style="color: #8b9985;">% </span><span style="color: #8b9985;">Rasta</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
R_max <span style="color: #00a6fb;">=</span> 1.4<span style="color: #00a6fb;">;</span>
C <span style="color: #00a6fb;">=</span> 100<span style="color: #00a6fb;">;</span> r_C     <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> R_max<span style="color: #00a6fb;">,</span> C)<span style="color: #00a6fb;">;</span>
A <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>   theta_A <span style="color: #00a6fb;">=</span> linspace(pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> A)<span style="color: #00a6fb;">;</span>
B <span style="color: #00a6fb;">=</span> 100<span style="color: #00a6fb;">;</span> phi_B   <span style="color: #00a6fb;">=</span> linspace(0<span style="color: #00a6fb;">,</span> 2<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">,</span>    B)<span style="color: #00a6fb;">;</span>
gg_CAB <span style="color: #00a6fb;">=</span> vectorgrid(r_C<span style="color: #00a6fb;">,</span> theta_A<span style="color: #00a6fb;">,</span> phi_B<span style="color: #00a6fb;">,</span> <span style="color: #096b38;">'spherical'</span>)<span style="color: #00a6fb;">;</span>
</pre>
</div>

<p>
frequency direction of plane wave
</p>
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #8b9985;">% </span><span style="color: #8b9985;">ebene Welle</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
C_snd <span style="color: #00a6fb;">=</span> 342<span style="color: #00a6fb;">;</span>                       <span style="color: #8b9985;">% m/s</span>
F     <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>                         <span style="color: #8b9985;">% Hz</span>
F_max <span style="color: #00a6fb;">=</span> 500<span style="color: #00a6fb;">;</span>                       <span style="color: #8b9985;">% Hz</span>
F_min <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>                         <span style="color: #8b9985;">% gleichf&#246;rmig unterteilt</span>
f_F   <span style="color: #00a6fb;">=</span> linspace(F_min<span style="color: #00a6fb;">,</span> F_max<span style="color: #00a6fb;">,</span> F)<span style="color: #00a6fb;">;</span> <span style="color: #8b9985;">% Frequenzen</span>
k_F   <span style="color: #00a6fb;">=</span> <span style="color: #00a6fb;">-</span>2<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">*</span>f_F<span style="color: #00a6fb;">/</span>C_snd<span style="color: #00a6fb;">;</span>           <span style="color: #8b9985;">% Wellenzahl</span>
                                   <span style="color: #8b9985;">%phi   = exp(i*0.5*pi/2);            % Phase einfallende Welle</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Vektor Einfallsrichtung</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>
Theta_src <span style="color: #00a6fb;">=</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">;</span>
Phi_src   <span style="color: #00a6fb;">=</span> 0.3<span style="color: #00a6fb;">*</span>pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">;</span>
R_src     <span style="color: #00a6fb;">=</span> 1.2<span style="color: #00a6fb;">;</span>
vM_src    <span style="color: #00a6fb;">=</span> vector(R_src<span style="color: #00a6fb;">,</span> Theta_src<span style="color: #00a6fb;">,</span> Phi_src<span style="color: #00a6fb;">,</span> <span style="color: #096b38;">'spherical'</span>)<span style="color: #00a6fb;">;</span>
</pre>
</div>

<p>
HOA approximation
</p>
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #8b9985;">% </span><span style="color: #8b9985;">"echte" Quelle, nicht Winkel-begrenzt</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Grid in lin. angeordnete Punktevektor bringen</span>
vm_E <span style="color: #00a6fb;">=</span> vectorgrid_vector(gg_CAB)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">Wellenzahlvektoren f&#252;r "echte" Lautsprecherschallfelder</span>
vk_F <span style="color: #00a6fb;">=</span> vector_scale(k_F<span style="color: #00a6fb;">,</span> vector_normalise(vM_src))<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">% </span><span style="color: #8b9985;">nicht-winkelbegrenzte Schallfelder eben</span>
P_real_EF <span style="color: #00a6fb;">=</span> planewave(vm_E<span style="color: #00a6fb;">,</span> vk_F)<span style="color: #00a6fb;">;</span>

<span style="color: #8b9985;">%  </span>
<span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
  <span style="color: #8b9985;">% umsortieren</span>
  P_CAB{1} <span style="color: #00a6fb;">=</span> vectorgrid_reshape(P_real_EF(<span style="color: #00a6fb;">:,</span>f)<span style="color: #00a6fb;">,</span> gg_CAB)<span style="color: #00a6fb;">;</span>
<span style="color: #0082c9;">end</span>


<span style="color: #8b9985;">%% </span><span style="color: #8b9985;">Koeffzi. der Fourier-Bessel-Reihe </span>
<span style="color: #8b9985;">%% </span><span style="color: #8b9985;">-----------------------------------------------------------------</span>
N_order_list <span style="color: #00a6fb;">=</span> [5<span style="color: #00a6fb;">,</span> 10]<span style="color: #00a6fb;">;</span>
S_norm <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'norm'</span><span style="color: #00a6fb;">;</span>
S_type <span style="color: #00a6fb;">=</span> <span style="color: #096b38;">'real'</span><span style="color: #00a6fb;">;</span>

<span style="color: #0082c9;">for</span> n <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>length(N_order_list)
  N_order <span style="color: #00a6fb;">=</span> N_order_list(n)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% Eingangsmode</span>
  Psi_src_O <span style="color: #00a6fb;">=</span> sphericalmodematrix(N_order<span style="color: #00a6fb;">,</span> Theta_src<span style="color: #00a6fb;">,</span> Phi_src<span style="color: #00a6fb;">,</span> S_norm<span style="color: #00a6fb;">,</span> S_type)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% Vorfaktor f&#252;r ebene Welle</span>
  N_pln_O <span style="color: #00a6fb;">=</span> sphericalnormalisation(N_order<span style="color: #00a6fb;">,</span> <span style="color: #096b38;">'planewave'</span>)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% HOA Koeff</span>
  A_pln_O <span style="color: #00a6fb;">=</span> N_pln_O <span style="color: #00a6fb;">.*</span> Psi_src_O<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% Druckverteilungen berechnet:</span>
  <span style="color: #8b9985;">% -------------------------------------------------------------------</span>

  <span style="color: #8b9985;">% SFC-Koeffzi.</span>
  C_pln_OC <span style="color: #00a6fb;">=</span> sphericalseries_sfc(A_pln_O<span style="color: #00a6fb;">,</span> []<span style="color: #00a6fb;">,</span> r_C<span style="color: #00a6fb;">,</span> inf<span style="color: #00a6fb;">,</span> k_F)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% Basisfunktion zum Rasta</span>
  Y_OAB <span style="color: #00a6fb;">=</span> sphericalharmonic(N_order<span style="color: #00a6fb;">,</span> theta_A<span style="color: #00a6fb;">,</span> phi_B<span style="color: #00a6fb;">,</span> S_norm<span style="color: #00a6fb;">,</span> S_type)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% ISF im Frequenzbereich</span>
  P_CAB{2<span style="color: #00a6fb;">*</span>n} <span style="color: #00a6fb;">=</span> sphericalseries_isf(C_pln_OC<span style="color: #00a6fb;">,</span> Y_OAB)<span style="color: #00a6fb;">;</span>

  <span style="color: #8b9985;">% Differenz zur idealen ebenen Welle</span>
  P_CAB{2<span style="color: #00a6fb;">*</span>n <span style="color: #00a6fb;">+</span> 1} <span style="color: #00a6fb;">=</span> P_CAB{2<span style="color: #00a6fb;">*</span>n} <span style="color: #00a6fb;">-</span> P_CAB{1}<span style="color: #00a6fb;">;</span>

<span style="color: #0082c9;">end</span> <span style="color: #8b9985;">% N_order_list</span>


<span style="color: #8b9985;">% </span><span style="color: #8b9985;">malen</span>
<span style="color: #8b9985;">% </span><span style="color: #8b9985;">-------------------------------------------------------------------</span>

v_view <span style="color: #00a6fb;">=</span> [0 90]<span style="color: #00a6fb;">;</span>
c_map <span style="color: #00a6fb;">=</span> colormap(badcolormap(256))<span style="color: #00a6fb;">;</span>
<span style="color: #8b9985;">%</span><span style="color: #8b9985;">c_map = colormap('hot');</span>
b_colorbar <span style="color: #00a6fb;">=</span> 0<span style="color: #00a6fb;">;</span>
b_print <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">;</span>

<span style="color: #0082c9;">if</span> <span style="color: #00a6fb;">~</span>isdir(<span style="color: #096b38;">'./Bilder'</span>)
    mkdir(<span style="color: #096b38;">'./Bilder'</span>)<span style="color: #00a6fb;">;</span>
<span style="color: #0082c9;">end</span>

<span style="color: #0082c9;">for</span> n <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>length(P_CAB)
  P_CABF <span style="color: #00a6fb;">=</span> P_CAB{n}<span style="color: #00a6fb;">;</span>
  
  <span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
    figure(20)<span style="color: #00a6fb;">;</span> clf<span style="color: #00a6fb;">;</span>
    vectorgrid_surface(gg_CAB<span style="color: #00a6fb;">,</span> squeeze((real(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f)))))<span style="color: #00a6fb;">;</span>
    c_minmax <span style="color: #00a6fb;">=</span> max(max(max(squeeze(abs(real(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f))))))) <span style="color: #00a6fb;">*</span> [<span style="color: #00a6fb;">-</span>1 1]<span style="color: #00a6fb;">;</span>
    caxis(c_minmax)<span style="color: #00a6fb;">;</span>
    colormap(c_map)<span style="color: #00a6fb;">;</span>
    plot_speaker(vM_src<span style="color: #00a6fb;">,</span> vM_src<span style="color: #00a6fb;">,</span> [1<span style="color: #00a6fb;">,</span> 0<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">,</span> [0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">'</span>)<span style="color: #00a6fb;">;</span>
    axis(<span style="color: #096b38;">'equal'</span>)<span style="color: #00a6fb;">;</span>
    grid(<span style="color: #096b38;">'on'</span>)<span style="color: #00a6fb;">;</span>
    view(v_view)<span style="color: #00a6fb;">;</span>
    title(<span style="color: #096b38;">'\Re p'</span>)<span style="color: #00a6fb;">;</span>
    xlabel(<span style="color: #096b38;">'x (m)'</span>)<span style="color: #00a6fb;">;</span>
    ylabel(<span style="color: #096b38;">'y (m)'</span>)<span style="color: #00a6fb;">;</span>
    zlabel(<span style="color: #096b38;">'z (m)'</span>)<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">if</span> b_colorbar colorbar<span style="color: #00a6fb;">;</span> <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
    figure(21)<span style="color: #00a6fb;">;</span> clf<span style="color: #00a6fb;">;</span>
    vectorgrid_surface(gg_CAB<span style="color: #00a6fb;">,</span> squeeze((imag(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f)))))<span style="color: #00a6fb;">;</span>
    c_minmax <span style="color: #00a6fb;">=</span> max(max(max(squeeze(abs(imag(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f))))))) <span style="color: #00a6fb;">*</span> [<span style="color: #00a6fb;">-</span>1 1]<span style="color: #00a6fb;">;</span>
    caxis(c_minmax)<span style="color: #00a6fb;">;</span>
    colormap(c_map)<span style="color: #00a6fb;">;</span>
    plot_speaker(vM_src<span style="color: #00a6fb;">,</span> vM_src<span style="color: #00a6fb;">,</span> [1<span style="color: #00a6fb;">,</span> 0<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">,</span> [0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">'</span>)<span style="color: #00a6fb;">;</span>
    axis(<span style="color: #096b38;">'equal'</span>)<span style="color: #00a6fb;">;</span>
    grid(<span style="color: #096b38;">'on'</span>)<span style="color: #00a6fb;">;</span>
    view(v_view)<span style="color: #00a6fb;">;</span>
    title(<span style="color: #096b38;">'\Im p'</span>)<span style="color: #00a6fb;">;</span>
    xlabel(<span style="color: #096b38;">'x (m)'</span>)<span style="color: #00a6fb;">;</span>
    ylabel(<span style="color: #096b38;">'y (m)'</span>)<span style="color: #00a6fb;">;</span>
    zlabel(<span style="color: #096b38;">'z (m)'</span>)<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">if</span> b_colorbar colorbar<span style="color: #00a6fb;">;</span> <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
    figure(22)<span style="color: #00a6fb;">;</span> clf<span style="color: #00a6fb;">;</span>
    vectorgrid_surface(gg_CAB<span style="color: #00a6fb;">,</span> squeeze((abs(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f)))))<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">if</span> n <span style="color: #00a6fb;">==</span> 1
      c_minmax <span style="color: #00a6fb;">=</span> [0 2]<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">else</span>
      c_minmax <span style="color: #00a6fb;">=</span> caxis<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">end</span>
    caxis(c_minmax)<span style="color: #00a6fb;">;</span>
    colormap(c_map)<span style="color: #00a6fb;">;</span>
    plot_speaker(vM_src<span style="color: #00a6fb;">,</span> vM_src<span style="color: #00a6fb;">,</span> [1<span style="color: #00a6fb;">,</span> 0<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">,</span> [0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">'</span>)<span style="color: #00a6fb;">;</span>
    axis(<span style="color: #096b38;">'equal'</span>)<span style="color: #00a6fb;">;</span>
    grid(<span style="color: #096b38;">'on'</span>)<span style="color: #00a6fb;">;</span>
    view(v_view)<span style="color: #00a6fb;">;</span>
    title(<span style="color: #096b38;">'|p|'</span>)<span style="color: #00a6fb;">;</span>
    xlabel(<span style="color: #096b38;">'x (m)'</span>)<span style="color: #00a6fb;">;</span>
    ylabel(<span style="color: #096b38;">'y (m)'</span>)<span style="color: #00a6fb;">;</span>
    zlabel(<span style="color: #096b38;">'z (m)'</span>)<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">if</span> b_colorbar colorbar<span style="color: #00a6fb;">;</span> <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">for</span> f <span style="color: #00a6fb;">=</span> 1<span style="color: #00a6fb;">:</span>F
    figure(23)<span style="color: #00a6fb;">;</span> clf<span style="color: #00a6fb;">;</span>
    vectorgrid_surface(gg_CAB<span style="color: #00a6fb;">,</span> squeeze((angle(P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f)))))<span style="color: #00a6fb;">;</span>
    c_minmax <span style="color: #00a6fb;">=</span> max(max(max(squeeze(angle((P_CABF(<span style="color: #00a6fb;">:,:,:,</span>f))))))) <span style="color: #00a6fb;">*</span> [<span style="color: #00a6fb;">-</span>1 1]<span style="color: #00a6fb;">;</span>
    caxis(c_minmax)<span style="color: #00a6fb;">;</span>
    colormap(c_map)<span style="color: #00a6fb;">;</span>
    plot_speaker(vM_src<span style="color: #00a6fb;">,</span> vM_src<span style="color: #00a6fb;">,</span> [1<span style="color: #00a6fb;">,</span> 0<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">,</span> [0<span style="color: #00a6fb;">,</span> pi<span style="color: #00a6fb;">/</span>2<span style="color: #00a6fb;">,</span> 0]<span style="color: #00a6fb;">'</span>)<span style="color: #00a6fb;">;</span>
    axis(<span style="color: #096b38;">'equal'</span>)<span style="color: #00a6fb;">;</span>
    grid(<span style="color: #096b38;">'on'</span>)<span style="color: #00a6fb;">;</span>
    view(v_view)<span style="color: #00a6fb;">;</span>
    title(<span style="color: #096b38;">'\angle p'</span>)<span style="color: #00a6fb;">;</span>
    xlabel(<span style="color: #096b38;">'x (m)'</span>)<span style="color: #00a6fb;">;</span>
    ylabel(<span style="color: #096b38;">'y (m)'</span>)<span style="color: #00a6fb;">;</span>
    zlabel(<span style="color: #096b38;">'z (m)'</span>)<span style="color: #00a6fb;">;</span>
    <span style="color: #0082c9;">if</span> b_colorbar colorbar<span style="color: #00a6fb;">;</span> <span style="color: #0082c9;">end</span>
  <span style="color: #0082c9;">end</span>

  <span style="color: #0082c9;">if</span> b_print
    figure(20)<span style="color: #00a6fb;">;</span>
    figuresize(3<span style="color: #00a6fb;">,</span> 3)<span style="color: #00a6fb;">;</span>
    figurefont(6)<span style="color: #00a6fb;">;</span>
    figuresave(sprintf(<span style="color: #096b38;">'Bilder/ebenewelle_%i_real.pdf'</span><span style="color: #00a6fb;">,</span> n))<span style="color: #00a6fb;">;</span>
    figure(21)<span style="color: #00a6fb;">;</span>
    figuresize(3<span style="color: #00a6fb;">,</span> 3)<span style="color: #00a6fb;">;</span>
    figurefont(6)<span style="color: #00a6fb;">;</span>
    figuresave(sprintf(<span style="color: #096b38;">'Bilder/ebenewelle_%i_imag.pdf'</span><span style="color: #00a6fb;">,</span> n))<span style="color: #00a6fb;">;</span>
    figure(22)<span style="color: #00a6fb;">;</span>
    figuresize(3<span style="color: #00a6fb;">,</span> 3)<span style="color: #00a6fb;">;</span>
    figurefont(6)<span style="color: #00a6fb;">;</span>
    figuresave(sprintf(<span style="color: #096b38;">'Bilder/ebenewelle_%i_abs.pdf'</span><span style="color: #00a6fb;">,</span> n))<span style="color: #00a6fb;">;</span>
    figure(23)<span style="color: #00a6fb;">;</span>
    figuresize(3<span style="color: #00a6fb;">,</span> 3)<span style="color: #00a6fb;">;</span>
    figurefont(6)<span style="color: #00a6fb;">;</span>
    figuresave(sprintf(<span style="color: #096b38;">'Bilder/ebenewelle_%i_angle.pdf'</span><span style="color: #00a6fb;">,</span> n))<span style="color: #00a6fb;">;</span>
  <span style="color: #0082c9;">end</span>
  <span style="color: #8b9985;">%  n</span>
  <span style="color: #8b9985;">% input('press return');</span>
<span style="color: #0082c9;">end</span>

</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: <span class="timestamp-wrapper"><span class="timestamp">&lt;2017-11-23 Do&gt; </span></span> Rev. Time-stamp: <span class="timestamp-wrapper"><span class="timestamp">&lt;2020-11-30 Mo 16:22&gt;</span></span></p>
<p class="author">Author: Johann-Markus Batke</p>
<p class="date">Created: 2020-11-30 Mo 16:22</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
